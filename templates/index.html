<html>
<head>
	<title>Twit hipster</title>
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.css" />
	<script type="text/javascript" src="/static/js/jq.js"></script>
	<script type="text/javascript" src="/static/js/bootstrap.js" ></script>
	<script type="text/javascript" src="/static/js/bootstrap-typeahead.js" ></script>
	<script type="text/javascript" src="/static/js/highcharts.js" ></script>

	<style type="text/css">
		#container form {
			padding-left: 400px;
		}
		#container form input {
			width: 300px;
			height: 35px;
		}
		.show-graph {
			width: 90%;
			text-align: center;
			color: #fff;
			padding: 5px 4px;
			font-size: 1.5em;
			background-color: #0D5995;
			border-radius: 5px;
			margin-left: 50px;
			margin-bottom: 20px;
		}
		.show-graph:hover {
			cursor: pointer;
		}
		#graf {
			width: 100%;
		}
		#content {
			display: none;
		}
		.span12 {
			margin-left: 0;
		}
	</style>

    <script type="text/javascript">
	$('document').ready(function(){

		$('.show-graph').click(function(){
			$('#graf').show();
			$(this).hide();
		});
		$('form').submit(function(event){
			event.preventDefault();
			$('.search').click();
		});
		$('.search').live('click', function(event){
			htag = encodeURIComponent($('input').val());
			//	alert(htag);
			$('.search i').removeClass('icon-search');
			$('.search i').toggleClass('icon-time');
			$.getJSON('/api/v.1/'+htag, function(data){
				$('tbody').html('');
	 			$.each(data.results, function(index, t){
	 				$('tbody').append('<tr><td><img src="'+t.image+'" /></td><td>'+t.text+'</td><td>'+t.date+'</td></tr>');
	 			});
	 			$('.search i').removeClass('icon-time').addClass('icon-search');
	 			$('#content').show();
			});
            $.getJSON('/api/graph/'+htag, function(data){
                chart.series[0].setData(data);
          	  });
			return false
	    });

	    /*$('.typeahead').typeahead({
	    source: function (typeahead, query) {
	    	    console.log($('.typeahead').val());
	            return $.get('/autocomplete', { q: query }, function (data) {
	                return typeahead.process(data);
	           });
	    }
	    });*/
	});
	</script>
	</head>


<body>

	<div id="container">
		<form class="well form-search">
		<!--input type="text" class="span3" style="margin: 0 auto;" data-provide="typeahead" data-items="4" data-source='["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","North Carolina","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]'-->
      <input type="text" placeholder="#tag" class="input-medium search-query typeahead span3" data-provide="typeahead" id="q" name="q" data-source="/autocomplete" data-items="10" data-provide="typeahead" style="margin: 0 auto;" />
   	   <i class="btn search" ><i class="icon icon-search" ></i>&nbsp;Search</i>
    </form>
	</div>
	
	<div id="content">
		<div class="span12">
			<div class="show-graph">Show graph</div>
			<div id="graf" style="display: none"></div>

			<div id="annual">
		</div>
	
	</div>

	<div class="span12">
      <table class="table table-condensed">
        <colgroup>
          <col class="span3">	
          <col class="span6">
          <col class="span3">
        </colgroup>
        <thead>
          <tr>
          	<th>User</th>
            <th>Tag</th>
            <th>Tweet</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
	</div>

	<script type="text/javascript">
	var chart;

	chart = new Highcharts.Chart({
            chart: {
                renderTo: 'graf',
                type: 'scatter',
                zoomType: 'xy'
            },
            title: {
                text: '#tag'
            },
            // subtitle: {
            //     text: 'Source: Heinz  2003'
            // },
            xAxis: {
                title: {
                    text: null
                },
                startOnTick: true,
                endOnTick: true,
                showLastLabel: true
            },
            yAxis: {
                title: {
                    // enabled: false
                    text: null
                }
            },
            plotOptions: {
                scatter: {
                    marker: {
                        radius: 5,
                        states: {
                            hover: {
                                enabled: true,
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    states: {
                        hover: {
                            marker: {
                                enabled: false
                            }
                        }
                    }
                }
            },
            series: [{
                name: 'tweets',
                color: 'rgba(223, 83, 83, .5)',
                data: [[161.2, 51.6], [167.5, 59.0], [159.5, 49.2], [157.0, 63.0], [155.8, 53.6]]
    
            }]
        });
          
	</script>
</body>
</html>
