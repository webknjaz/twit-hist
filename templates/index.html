<html>
<head>
	<title>Twit hipster</title>
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.css" />
	<script type="text/javascript" src="/static/js/jq.js"></script>
	<script type="text/javascript" src="/static/js/bootstrap.js" ></script>
	<script type="text/javascript" src="/static/js/bootstrap-typeahead.js" ></script>
	<script type="text/javascript" src="/static/js/highcharts.js" ></script>

	<style type="text/css">
		#container form {
			padding-left: 400px;
		}
		#container form input {
			width: 300px;
			height: 35px;
		}
		.show-graph {
			width: 90%;
			text-align: center;
			color: #fff;
			padding: 5px 4px;
			font-size: 1.5em;
			background-color: #0D5995;
			border-radius: 5px;
			margin-left: 50px;
			margin-bottom: 20px;
		}
		.show-graph:hover {
			cursor: pointer;
		}
		#graf {
			width: 100%;
		}
		#content {
			display: none;
		}
		.span12 {
			margin-left: 0;
		}
	</style>

    <script type="text/javascript">
	$('document').ready(function(){

		$('.show-graph').click(function(){
			$('#graf').show();
			$(this).hide();
		});
		$('form').submit(function(event){
			event.preventDefault();
			$('.search').click();
		});
		$('.search').live('click', function(event){
			htag = encodeURIComponent($('input').val());
			//	alert(htag);
			$('.search i').removeClass('icon-search');
			$('.search i').toggleClass('icon-time');
			$.getJSON('/api/v.1/'+htag, function(data){
				$('tbody').html('');
	 			$.each(data.results, function(index, t){
	 				$('tbody').append('<tr><td><img src="'+t.image+'" /></td><td>'+t.text+'</td><td>'+t.date+'</td></tr>');
	 			});
	 			$('.search i').removeClass('icon-time').addClass('icon-search');
	 			$('#content').show();
	 			$(chart.title.element).text(decodeURIComponent(htag));
			});
            $.getJSON('/api/graph/'+htag, function(data){
                // alert(data);
                chart.series[0].setData(data);
          	  });
			return false
	    });

	    /*$('.typeahead').typeahead({
	    source: function (typeahead, query) {
	    	    console.log($('.typeahead').val());
	            return $.get('/autocomplete', { q: query }, function (data) {
	                return typeahead.process(data);
	           });
	    }
	    });*/
	});
	</script>
	</head>


<body>

	<div id="container">
		<form class="well form-search">
		<!--input type="text" class="span3" style="margin: 0 auto;" data-provide="typeahead" data-items="4" data-source='["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","North Carolina","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]'-->
      <input type="text" placeholder="#tag" class="input-medium search-query typeahead span3" data-provide="typeahead" id="q" name="q" data-source="/autocomplete" data-items="10" data-provide="typeahead" style="margin: 0 auto;" />
   	   <i class="btn search" ><i class="icon icon-search" ></i>&nbsp;Search</i>
    </form>
	</div>
	
	<div id="content">
		<div class="span12">
			<div class="show-graph">Show graph</div>
			<div id="graf" style="display: none"></div>

			<div id="annual">
		</div>
	
	</div>

	<div class="span12">
      <table class="table table-condensed">
        <colgroup>
          <col class="span3">	
          <col class="span6">
          <col class="span3">
        </colgroup>
        <thead>
          <tr>
          	<th>User</th>
            <th>Tag</th>
            <th>Tweet</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
	</div>

	<script type="text/javascript">
	var chart;

	chart = new Highcharts.Chart({
            chart: {
                renderTo: 'graf',
                type: 'spline',
                // zoomType: 'xy'
            },
            title: {
                text: '#tag'
            },
            xAxis: {
                title: 'days ago'
                // type: 'datetime',
                // dateTimeLabelFormats: { // don't display the dummy year
                //     month: '%e. %b',
                //     year: '%b'
                // }
            },
            yAxis: {
                title: {
                    text: 'Snow depth (m)'
                },
                min: 0
            },
            // tooltip: {
            //     formatter: function() {
            //             return '<b>'+ this.series.name +'</b><br/>'+
            //             Highcharts.dateFormat('%e. %b', this.x) +': '+ this.y +' m';
            //     }
            // },
            series: [{
                name: 'tweets',
                data: null
            }]
        });
          
	</script>
</body>
</html>
